--======================================================================--
-- @作者: GGE研究群: 342119466
-- @创建时间:   2018-03-03 02:34:19
-- @Last Modified time: 2021-01-26 19:28:38
-- 梦幻西游游戏资源破解 baidwwy@vip.qq.com(313738139) 老毕   和 C++PrimerPlus 717535046 这俩位大神破解所以资源
--======================================================================--
local 战斗类 = class()
local yxs = require("script/资源类/FSB")
local zts
function 战斗类:初始化(根)
  local jl = require("gge精灵类")
  local 资源 = 根.资源
  zts = tp.字体表.普通字体
  self.敌方位置={[1]={["y"]=180,["x"]=185},[3]={["y"]=150,["x"]=245},[2]={["y"]=210,["x"]=125},[4]={["y"]=240,["x"]=65},[5]={["y"]=120,["x"]=305},[6]={["y"]=220,["x"]=230},[7]={["y"]=250,["x"]=170},[8]={["y"]=190,["x"]=290},[9]={["y"]=280,["x"]=110},[10]={["y"]=160,["x"]=350}}
  self.我方位置={[3]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-155},[1]={["y"]=全局游戏高度-175,["x"]=全局游戏宽度-215},[5]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-95},[2]={["y"]=全局游戏高度-145,["x"]=全局游戏宽度-275},[4]={["y"]=全局游戏高度-115,["x"]=全局游戏宽度-335},[8]={["y"]=全局游戏高度-265,["x"]=全局游戏宽度-225},[6]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-285},[10]={["y"]=全局游戏高度-295,["x"]=全局游戏宽度-165},[7]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-345},[9]={["y"]=全局游戏高度-175,["x"]=全局游戏宽度-405},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}}
  self.阵型位置={}
  self.阵型位置.天覆阵={我方={[3]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-155},[1]={["y"]=全局游戏高度-136,["x"]=全局游戏宽度-172},[5]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-95},[2]={["y"]=全局游戏高度-145,["x"]=全局游戏宽度-275},[4]={["y"]=全局游戏高度-115,["x"]=全局游戏宽度-335},[8]={["y"]=全局游戏高度-265,["x"]=全局游戏宽度-225},[6]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-285},[10]={["y"]=全局游戏高度-295,["x"]=全局游戏宽度-165},[7]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-345},[9]={["y"]=全局游戏高度-175,["x"]=全局游戏宽度-405},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
  敌方={[1]={["y"]=183,["x"]=310},[2]={["y"]=240,["x"]=295},[3]={["y"]=180,["x"]=415},[4]={["y"]=270,["x"]=235},[5]={["y"]=150,["x"]=475},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
  self.阵型位置.云垂阵={我方={[1]={["y"]=全局游戏高度-131,["x"]=全局游戏宽度-142},[2]={["y"]=全局游戏高度-185,["x"]=全局游戏宽度-305},[3]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-185},[4]={["y"]=全局游戏高度-155,["x"]=全局游戏宽度-365},[5]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-125},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
  敌方={[1]={["y"]=156,["x"]=269},[2]={["y"]=240,["x"]=295},[3]={["y"]=180,["x"]=415},[4]={["y"]=270,["x"]=235},[5]={["y"]=150,["x"]=475},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
  self.阵型位置.风扬阵={我方={[1]={["y"]=全局游戏高度-147,["x"]=全局游戏宽度-174},[2]={["y"]=全局游戏高度-179,["x"]=全局游戏宽度-105},[3]={["y"]=全局游戏高度-104,["x"]=全局游戏宽度-249},[4]={["y"]=全局游戏高度-240,["x"]=全局游戏宽度-181},[5]={["y"]=全局游戏高度-170,["x"]=全局游戏宽度-312},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
  敌方={[1]={["y"]=189,["x"]=287},[2]={["y"]=214,["x"]=220},[3]={["y"]=143,["x"]=352},[4]={["y"]=248,["x"]=280},[5]={["y"]=191,["x"]=406},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
  self.阵型位置.虎翼阵={我方={[1]={["y"]=全局游戏高度-139,["x"]=全局游戏宽度-129},[2]={["y"]=全局游戏高度-219,["x"]=全局游戏宽度-137},[3]={["y"]=全局游戏高度-144,["x"]=全局游戏宽度-251},[4]={["y"]=全局游戏高度-291,["x"]=全局游戏宽度-135},[5]={["y"]=全局游戏高度-160,["x"]=全局游戏宽度-362},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
  敌方={[1]={["y"]=142,["x"]=257},[2]={["y"]=209,["x"]=230},[3]={["y"]=146,["x"]=365},[4]={["y"]=275,["x"]=223},[5]={["y"]=160,["x"]=459},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
  self.阵型位置.鸟翔阵={我方={[1]={["y"]=全局游戏高度-192,["x"]=全局游戏宽度-218},[2]={["y"]=全局游戏高度-197,["x"]=全局游戏宽度-86},[3]={["y"]=全局游戏高度-114,["x"]=全局游戏宽度-260},[4]={["y"]=全局游戏高度-289,["x"]=全局游戏宽度-137},[5]={["y"]=全局游戏高度-150,["x"]=全局游戏宽度-382},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
  敌方={[1]={["y"]=203,["x"]=347},[2]={["y"]=196,["x"]=239},[3]={["y"]=136,["x"]=369},[4]={["y"]=275,["x"]=223},[5]={["y"]=154,["x"]=470},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}} }
  self.阵型位置.地载阵={我方={[1]={["y"]=全局游戏高度-166,["x"]=全局游戏宽度-196},[2]={["y"]=全局游戏高度-218,["x"]=全局游戏宽度-261},[3]={["y"]=全局游戏高度-193,["x"]=全局游戏宽度-137},[4]={["y"]=全局游戏高度-142,["x"]=全局游戏宽度-276},[5]={["y"]=全局游戏高度-105,["x"]=全局游戏宽度-129},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
  敌方={[1]={["y"]=167,["x"]=306},[2]={["y"]=211,["x"]=355},[3]={["y"]=200,["x"]=242},[4]={["y"]=134,["x"]=376},[5]={["y"]=121,["x"]=251},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
  self.阵型位置.龙飞阵={我方={[1]={["y"]=全局游戏高度-162,["x"]=全局游戏宽度-197},[2]={["y"]=全局游戏高度-118,["x"]=全局游戏宽度-140},[3]={["y"]=全局游戏高度-283,["x"]=全局游戏宽度-142},[4]={["y"]=全局游戏高度-191,["x"]=全局游戏宽度-332},[5]={["y"]=全局游戏高度-216,["x"]=全局游戏宽度-254},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
  敌方={[1]={["y"]=174,["x"]=277},[2]={["y"]=124,["x"]=215},[3]={["y"]=269,["x"]=223},[4]={["y"]=168,["x"]=407},[5]={["y"]=212,["x"]=330},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
  self.阵型位置.蛇蟠阵={我方={[1]={["y"]=全局游戏高度-162,["x"]=全局游戏宽度-197},[2]={["y"]=全局游戏高度-125,["x"]=全局游戏宽度-268},[3]={["y"]=全局游戏高度-182,["x"]=全局游戏宽度-130},[4]={["y"]=全局游戏高度-191,["x"]=全局游戏宽度-332},[5]={["y"]=全局游戏高度-95,["x"]=全局游戏宽度-124},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
  敌方={[1]={["y"]=174,["x"]=277},[2]={["y"]=132,["x"]=351},[3]={["y"]=218,["x"]=201},[4]={["y"]=168,["x"]=407},[5]={["y"]=128,["x"]=223},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
  self.阵型位置.鹰啸阵={我方={[1]={["y"]=全局游戏高度-162,["x"]=全局游戏宽度-137},[2]={["y"]=全局游戏高度-186,["x"]=全局游戏宽度-267},[3]={["y"]=全局游戏高度-249,["x"]=全局游戏宽度-131},[4]={["y"]=全局游戏高度-214,["x"]=全局游戏宽度-202},[5]={["y"]=全局游戏高度-98,["x"]=全局游戏宽度-64},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-255},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-315},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-195},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-375},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
  敌方={[1]={["y"]=174,["x"]=277},[2]={["y"]=168,["x"]=408},[3]={["y"]=247,["x"]=274},[4]={["y"]=211,["x"]=341},[5]={["y"]=128,["x"]=223},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
  self.阵型位置.雷绝阵={我方={[1]={["y"]=全局游戏高度-121,["x"]=全局游戏宽度-116},[2]={["y"]=全局游戏高度-123,["x"]=全局游戏宽度-245},[3]={["y"]=全局游戏高度-201,["x"]=全局游戏宽度-97},[4]={["y"]=全局游戏高度-185,["x"]=全局游戏宽度-319},[5]={["y"]=全局游戏高度-251,["x"]=全局游戏宽度-187},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
  敌方={[1]={["y"]=130,["x"]=234},[2]={["y"]=131,["x"]=335},[3]={["y"]=201,["x"]=234},[4]={["y"]=170,["x"]=401},[5]={["y"]=253,["x"]=289},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
  self.纯色背景 = jl(0,0,0,全局游戏宽度+500,全局游戏高度+300)
  self.纯色背景:置颜色(-1189208494)
  self.黑幕背景 = jl(0,0,0,全局游戏宽度+500,全局游戏高度+300)
  self.黑幕背景:置颜色(0xFF000000)
  self.战斗背景 = 资源:载入('wzife.wd5',"网易WDF动画",0x00D17553)----资源:载入('wzife.wd5',"网易WDF动画",0x00D17553)圆圈
  self.战斗圆背景 = 资源:载入('wzife.wdf',"网易WDF动画",0XD4BAB272)
  self.背景状态 = 0
  self.回合进程="加载"
  self.加载数量=0
  self.战斗单位={}
  self.观战模式=false
  self.战斗类型=0
  self.观战按钮 = 根._按钮.创建(根.资源:载入('wzife.wdf',"网易WDF动画",0x86D66B9A),0,0,4,true,nil,"退出观战")
  self.切换阵营 = 根._按钮.创建(根.资源:载入('wzife.wdf',"网易WDF动画",0x86D66B9A),0,0,4,true,nil,"切换对阵")
  self.观战底图 = 资源:载入('wzife.wdf',"网易WDF动画",0x229071B4)
  self.血条背景 = 资源:载入('addon.wdf',"网易WDF动画",0x4D0A334C)
  self.血条栏 = 资源:载入('addon.wdf',"网易WDF动画",0x4FD9FFF3)
  -- self.自动栏 = 资源:载入('wzife.wdf',"网易WDF动画",0x1DF7B97D)
  self.自动栏 = require("script/战斗类/战斗自动栏").创建(根)
  self.战斗指令=战斗指令类(根)
  self.进程="等待"
  self.自动开关=false
  self.数字图片=tp.战斗文字[5]
  self.请等待=资源:载入('misc.wdf',"网易WDF动画",0xEE1713AC)
  local wz = require("gge文字类")
  self.战斗信息提示={开关=false,内容="",起始时间=0,停止时间=0,字体=wz.创建(nil,16,false,false,false),}
  self.拼接偏移 = 生成XY()
  self.法宝图片 = tp.战斗文字[1]
  self.战斗快捷键法术=nil
  self.宠物战斗快捷键法术=nil
end

function 战斗类:设置命令回合(数据)
  self.战斗指令:更新类型(数据)
  self.进程="命令"
  self.命令数据={计时=时间,分=3,秒=0}
end

function 战斗类:是否开启自动()
  for n=1,#self.战斗单位 do
    if self.战斗单位[n].数据.自动战斗 and self.战斗单位[n].数据.类型=="角色" and self.战斗单位[n].数据.id==tp.队伍[1].数字id and self.战斗单位[n].数据.助战编号==nil then
      self.自动开关=true
    end
  end
end

function 战斗类:加载单位(数据,观战)

  self.战斗单位[#self.战斗单位+1]=战斗单位类()
  self.战斗单位[#self.战斗单位]:创建单位(数据,self.队伍id,#self.战斗单位)
  if #self.战斗单位==self.单位总数 then
    发送数据(5501,{名称=tp.队伍[1].名称})
    self:是否开启自动()
  end
  if 观战~= nil then
    self.观战模式=true
    if 数据.战斗类型 ~= nil and 数据.战斗类型 == 200003 then
      self.战斗类型=数据.战斗类型
    end
  end
end

function 战斗类:设置战斗流程(内容)
  self.战斗流程=内容
  for n=1,#self.战斗流程 do
    if self.战斗流程~=nil and self.战斗流程[n]~=nil then
      self.战斗流程[n].执行=false
      self.战斗流程[n].允许=false
    end
  end
  if #self.战斗流程==0 then
    self.进程="等待"
    发送数据(5503)
    return
  end
 self.进程="计算"
end

function 战斗类:鬼魂复活(内容)
  self.战斗单位[内容.id].停止更新=false
  self.战斗单位[内容.id]:换动作("待战")
  self.战斗单位[内容.id]:设置掉血(内容.气血,2)
end

function 战斗类:取消状态(内容)
  self.战斗单位[内容.id].状态特效[内容.名称]=nil
  if 内容.名称=="金刚护法" or 内容.名称=="分身术" or 内容.名称=="修罗隐身" or 内容.名称=="楚楚可怜" then
    self.战斗单位[内容.id]:取消变相()
  end
end

function 战斗类:刷新技能(内容)
  self.战斗单位[内容.id].主动技能=内容.主动技能
end

function 战斗类:刷新阵法位置(敌我)
  if 敌我 == nil then
    self.敌方位置={[1]={["y"]=180,["x"]=185},[3]={["y"]=150,["x"]=245},[2]={["y"]=210,["x"]=125},[4]={["y"]=240,["x"]=65},[5]={["y"]=120+30,["x"]=305+30},[6]={["y"]=220+30,["x"]=230+30},[7]={["y"]=250+30,["x"]=170+30},[8]={["y"]=190+30,["x"]=290+30},[9]={["y"]=280+30,["x"]=110+30},[10]={["y"]=160+30,["x"]=350+30}}

    --self.敌方位置={[1]={["y"]=180,["x"]=185},[3]={["y"]=150,["x"]=245},[2]={["y"]=210,["x"]=125},[4]={["y"]=240,["x"]=65},[5]={["y"]=120,["x"]=305},[6]={["y"]=220,["x"]=230},[7]={["y"]=250,["x"]=170},[8]={["y"]=190,["x"]=290},[9]={["y"]=280,["x"]=110},[10]={["y"]=160,["x"]=350}}
    self.我方位置={[3]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-155},[1]={["y"]=全局游戏高度-175,["x"]=全局游戏宽度-215},[5]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-95},[2]={["y"]=全局游戏高度-145,["x"]=全局游戏宽度-275},[4]={["y"]=全局游戏高度-115,["x"]=全局游戏宽度-335},[8]={["y"]=全局游戏高度-265,["x"]=全局游戏宽度-225},[6]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-285},[10]={["y"]=全局游戏高度-295,["x"]=全局游戏宽度-165},[7]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-345},[9]={["y"]=全局游戏高度-175,["x"]=全局游戏宽度-405},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}}
    self.阵型位置={}
    self.阵型位置.天覆阵={我方={[3]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-155},[1]={["y"]=全局游戏高度-136,["x"]=全局游戏宽度-172},[5]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-95},[2]={["y"]=全局游戏高度-145,["x"]=全局游戏宽度-275},[4]={["y"]=全局游戏高度-115,["x"]=全局游戏宽度-335},[8]={["y"]=全局游戏高度-265,["x"]=全局游戏宽度-225},[6]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-285},[10]={["y"]=全局游戏高度-295,["x"]=全局游戏宽度-165},[7]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-345},[9]={["y"]=全局游戏高度-175,["x"]=全局游戏宽度-405},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=183,["x"]=310},[2]={["y"]=240,["x"]=295},[3]={["y"]=180,["x"]=415},[4]={["y"]=270,["x"]=235},[5]={["y"]=150,["x"]=475},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.云垂阵={我方={[1]={["y"]=全局游戏高度-131,["x"]=全局游戏宽度-142},[2]={["y"]=全局游戏高度-185,["x"]=全局游戏宽度-305},[3]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-185},[4]={["y"]=全局游戏高度-155,["x"]=全局游戏宽度-365},[5]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-125},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=156,["x"]=269},[2]={["y"]=240,["x"]=295},[3]={["y"]=180,["x"]=415},[4]={["y"]=270,["x"]=235},[5]={["y"]=150,["x"]=475},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.风扬阵={我方={[1]={["y"]=全局游戏高度-147,["x"]=全局游戏宽度-174},[2]={["y"]=全局游戏高度-179,["x"]=全局游戏宽度-105},[3]={["y"]=全局游戏高度-104,["x"]=全局游戏宽度-249},[4]={["y"]=全局游戏高度-240,["x"]=全局游戏宽度-181},[5]={["y"]=全局游戏高度-170,["x"]=全局游戏宽度-312},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=189,["x"]=287},[2]={["y"]=214,["x"]=220},[3]={["y"]=143,["x"]=352},[4]={["y"]=248,["x"]=280},[5]={["y"]=191,["x"]=406},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.虎翼阵={我方={[1]={["y"]=全局游戏高度-139,["x"]=全局游戏宽度-129},[2]={["y"]=全局游戏高度-219,["x"]=全局游戏宽度-137},[3]={["y"]=全局游戏高度-144,["x"]=全局游戏宽度-251},[4]={["y"]=全局游戏高度-291,["x"]=全局游戏宽度-135},[5]={["y"]=全局游戏高度-160,["x"]=全局游戏宽度-362},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=142,["x"]=257},[2]={["y"]=209,["x"]=230},[3]={["y"]=146,["x"]=365},[4]={["y"]=275,["x"]=223},[5]={["y"]=160,["x"]=459},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.鸟翔阵={我方={[1]={["y"]=全局游戏高度-192,["x"]=全局游戏宽度-218},[2]={["y"]=全局游戏高度-197,["x"]=全局游戏宽度-86},[3]={["y"]=全局游戏高度-114,["x"]=全局游戏宽度-260},[4]={["y"]=全局游戏高度-289,["x"]=全局游戏宽度-137},[5]={["y"]=全局游戏高度-150,["x"]=全局游戏宽度-382},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=203,["x"]=347},[2]={["y"]=196,["x"]=239},[3]={["y"]=136,["x"]=369},[4]={["y"]=275,["x"]=223},[5]={["y"]=154,["x"]=470},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}} }
    self.阵型位置.地载阵={我方={[1]={["y"]=全局游戏高度-166,["x"]=全局游戏宽度-196},[2]={["y"]=全局游戏高度-218,["x"]=全局游戏宽度-261},[3]={["y"]=全局游戏高度-193,["x"]=全局游戏宽度-137},[4]={["y"]=全局游戏高度-142,["x"]=全局游戏宽度-276},[5]={["y"]=全局游戏高度-105,["x"]=全局游戏宽度-129},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=167,["x"]=306},[2]={["y"]=211,["x"]=355},[3]={["y"]=200,["x"]=242},[4]={["y"]=134,["x"]=376},[5]={["y"]=121,["x"]=251},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.龙飞阵={我方={[1]={["y"]=全局游戏高度-162,["x"]=全局游戏宽度-197},[2]={["y"]=全局游戏高度-118,["x"]=全局游戏宽度-140},[3]={["y"]=全局游戏高度-283,["x"]=全局游戏宽度-142},[4]={["y"]=全局游戏高度-191,["x"]=全局游戏宽度-332},[5]={["y"]=全局游戏高度-216,["x"]=全局游戏宽度-254},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=174,["x"]=277},[2]={["y"]=124,["x"]=215},[3]={["y"]=269,["x"]=223},[4]={["y"]=168,["x"]=407},[5]={["y"]=212,["x"]=330},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.蛇蟠阵={我方={[1]={["y"]=全局游戏高度-162,["x"]=全局游戏宽度-197},[2]={["y"]=全局游戏高度-125,["x"]=全局游戏宽度-268},[3]={["y"]=全局游戏高度-182,["x"]=全局游戏宽度-130},[4]={["y"]=全局游戏高度-191,["x"]=全局游戏宽度-332},[5]={["y"]=全局游戏高度-95,["x"]=全局游戏宽度-124},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=174,["x"]=277},[2]={["y"]=132,["x"]=351},[3]={["y"]=218,["x"]=201},[4]={["y"]=168,["x"]=407},[5]={["y"]=128,["x"]=223},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.鹰啸阵={我方={[1]={["y"]=全局游戏高度-162,["x"]=全局游戏宽度-137},[2]={["y"]=全局游戏高度-186,["x"]=全局游戏宽度-267},[3]={["y"]=全局游戏高度-249,["x"]=全局游戏宽度-131},[4]={["y"]=全局游戏高度-214,["x"]=全局游戏宽度-202},[5]={["y"]=全局游戏高度-98,["x"]=全局游戏宽度-64},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-255},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-315},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-195},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-375},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-725},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=174,["x"]=277},[2]={["y"]=168,["x"]=408},[3]={["y"]=247,["x"]=274},[4]={["y"]=211,["x"]=341},[5]={["y"]=128,["x"]=223},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.雷绝阵={我方={[1]={["y"]=全局游戏高度-121,["x"]=全局游戏宽度-116},[2]={["y"]=全局游戏高度-123,["x"]=全局游戏宽度-245},[3]={["y"]=全局游戏高度-201,["x"]=全局游戏宽度-97},[4]={["y"]=全局游戏高度-185,["x"]=全局游戏宽度-319},[5]={["y"]=全局游戏高度-251,["x"]=全局游戏宽度-187},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=130,["x"]=234},[2]={["y"]=131,["x"]=335},[3]={["y"]=201,["x"]=234},[4]={["y"]=170,["x"]=401},[5]={["y"]=253,["x"]=289},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}

  elseif 敌我 then
    self.敌方位置={[1]={["y"]=180,["x"]=185},[3]={["y"]=150,["x"]=245},[2]={["y"]=210,["x"]=125},[4]={["y"]=240,["x"]=65},[5]={["y"]=120+30,["x"]=305+30},[6]={["y"]=220+30,["x"]=230+30},[7]={["y"]=250+30,["x"]=170+30},[8]={["y"]=190+30,["x"]=290+30},[9]={["y"]=280+30,["x"]=110+30},[10]={["y"]=160+30,["x"]=350+30}}

    --self.敌方位置={[1]={["y"]=180,["x"]=185},[3]={["y"]=150,["x"]=245},[2]={["y"]=210,["x"]=125},[4]={["y"]=240,["x"]=65},[5]={["y"]=120,["x"]=305},[6]={["y"]=220,["x"]=230},[7]={["y"]=250,["x"]=170},[8]={["y"]=190,["x"]=290},[9]={["y"]=280,["x"]=110},[10]={["y"]=160,["x"]=350}}
    self.我方位置={[3]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-155},[1]={["y"]=全局游戏高度-175,["x"]=全局游戏宽度-215},[5]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-95},[2]={["y"]=全局游戏高度-145,["x"]=全局游戏宽度-275},[4]={["y"]=全局游戏高度-115,["x"]=全局游戏宽度-335},[8]={["y"]=全局游戏高度-265,["x"]=全局游戏宽度-225},[6]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-285},[10]={["y"]=全局游戏高度-295,["x"]=全局游戏宽度-165},[7]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-345},[9]={["y"]=全局游戏高度-175,["x"]=全局游戏宽度-405},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}}
    self.阵型位置={}
    self.阵型位置.天覆阵={我方={[3]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-155},[1]={["y"]=全局游戏高度-136,["x"]=全局游戏宽度-172},[5]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-95},[2]={["y"]=全局游戏高度-145,["x"]=全局游戏宽度-275},[4]={["y"]=全局游戏高度-115,["x"]=全局游戏宽度-335},[8]={["y"]=全局游戏高度-265,["x"]=全局游戏宽度-225},[6]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-285},[10]={["y"]=全局游戏高度-295,["x"]=全局游戏宽度-165},[7]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-345},[9]={["y"]=全局游戏高度-175,["x"]=全局游戏宽度-405},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=183,["x"]=310},[2]={["y"]=240,["x"]=295},[3]={["y"]=180,["x"]=415},[4]={["y"]=270,["x"]=235},[5]={["y"]=150,["x"]=475},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.云垂阵={我方={[1]={["y"]=全局游戏高度-131,["x"]=全局游戏宽度-142},[2]={["y"]=全局游戏高度-185,["x"]=全局游戏宽度-305},[3]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-185},[4]={["y"]=全局游戏高度-155,["x"]=全局游戏宽度-365},[5]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-125},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=156,["x"]=269},[2]={["y"]=240,["x"]=295},[3]={["y"]=180,["x"]=415},[4]={["y"]=270,["x"]=235},[5]={["y"]=150,["x"]=475},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.风扬阵={我方={[1]={["y"]=全局游戏高度-147,["x"]=全局游戏宽度-174},[2]={["y"]=全局游戏高度-179,["x"]=全局游戏宽度-105},[3]={["y"]=全局游戏高度-104,["x"]=全局游戏宽度-249},[4]={["y"]=全局游戏高度-240,["x"]=全局游戏宽度-181},[5]={["y"]=全局游戏高度-170,["x"]=全局游戏宽度-312},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=189,["x"]=287},[2]={["y"]=214,["x"]=220},[3]={["y"]=143,["x"]=352},[4]={["y"]=248,["x"]=280},[5]={["y"]=191,["x"]=406},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.虎翼阵={我方={[1]={["y"]=全局游戏高度-139,["x"]=全局游戏宽度-129},[2]={["y"]=全局游戏高度-219,["x"]=全局游戏宽度-137},[3]={["y"]=全局游戏高度-144,["x"]=全局游戏宽度-251},[4]={["y"]=全局游戏高度-291,["x"]=全局游戏宽度-135},[5]={["y"]=全局游戏高度-160,["x"]=全局游戏宽度-362},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=142,["x"]=257},[2]={["y"]=209,["x"]=230},[3]={["y"]=146,["x"]=365},[4]={["y"]=275,["x"]=223},[5]={["y"]=160,["x"]=459},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.鸟翔阵={我方={[1]={["y"]=全局游戏高度-192,["x"]=全局游戏宽度-218},[2]={["y"]=全局游戏高度-197,["x"]=全局游戏宽度-86},[3]={["y"]=全局游戏高度-114,["x"]=全局游戏宽度-260},[4]={["y"]=全局游戏高度-289,["x"]=全局游戏宽度-137},[5]={["y"]=全局游戏高度-150,["x"]=全局游戏宽度-382},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=203,["x"]=347},[2]={["y"]=196,["x"]=239},[3]={["y"]=136,["x"]=369},[4]={["y"]=275,["x"]=223},[5]={["y"]=154,["x"]=470},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}} }
    self.阵型位置.地载阵={我方={[1]={["y"]=全局游戏高度-166,["x"]=全局游戏宽度-196},[2]={["y"]=全局游戏高度-218,["x"]=全局游戏宽度-261},[3]={["y"]=全局游戏高度-193,["x"]=全局游戏宽度-137},[4]={["y"]=全局游戏高度-142,["x"]=全局游戏宽度-276},[5]={["y"]=全局游戏高度-105,["x"]=全局游戏宽度-129},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=167,["x"]=306},[2]={["y"]=211,["x"]=355},[3]={["y"]=200,["x"]=242},[4]={["y"]=134,["x"]=376},[5]={["y"]=121,["x"]=251},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.龙飞阵={我方={[1]={["y"]=全局游戏高度-162,["x"]=全局游戏宽度-197},[2]={["y"]=全局游戏高度-118,["x"]=全局游戏宽度-140},[3]={["y"]=全局游戏高度-283,["x"]=全局游戏宽度-142},[4]={["y"]=全局游戏高度-191,["x"]=全局游戏宽度-332},[5]={["y"]=全局游戏高度-216,["x"]=全局游戏宽度-254},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=174,["x"]=277},[2]={["y"]=124,["x"]=215},[3]={["y"]=269,["x"]=223},[4]={["y"]=168,["x"]=407},[5]={["y"]=212,["x"]=330},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.蛇蟠阵={我方={[1]={["y"]=全局游戏高度-162,["x"]=全局游戏宽度-197},[2]={["y"]=全局游戏高度-125,["x"]=全局游戏宽度-268},[3]={["y"]=全局游戏高度-182,["x"]=全局游戏宽度-130},[4]={["y"]=全局游戏高度-191,["x"]=全局游戏宽度-332},[5]={["y"]=全局游戏高度-95,["x"]=全局游戏宽度-124},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=174,["x"]=277},[2]={["y"]=132,["x"]=351},[3]={["y"]=218,["x"]=201},[4]={["y"]=168,["x"]=407},[5]={["y"]=128,["x"]=223},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.鹰啸阵={我方={[1]={["y"]=全局游戏高度-162,["x"]=全局游戏宽度-137},[2]={["y"]=全局游戏高度-186,["x"]=全局游戏宽度-267},[3]={["y"]=全局游戏高度-249,["x"]=全局游戏宽度-131},[4]={["y"]=全局游戏高度-214,["x"]=全局游戏宽度-202},[5]={["y"]=全局游戏高度-98,["x"]=全局游戏宽度-64},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-255},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-315},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-195},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-375},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-725},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=174,["x"]=277},[2]={["y"]=168,["x"]=408},[3]={["y"]=247,["x"]=274},[4]={["y"]=211,["x"]=341},[5]={["y"]=128,["x"]=223},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.雷绝阵={我方={[1]={["y"]=全局游戏高度-121,["x"]=全局游戏宽度-116},[2]={["y"]=全局游戏高度-123,["x"]=全局游戏宽度-245},[3]={["y"]=全局游戏高度-201,["x"]=全局游戏宽度-97},[4]={["y"]=全局游戏高度-185,["x"]=全局游戏宽度-319},[5]={["y"]=全局游戏高度-251,["x"]=全局游戏宽度-187},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=130,["x"]=234},[2]={["y"]=131,["x"]=335},[3]={["y"]=201,["x"]=234},[4]={["y"]=170,["x"]=401},[5]={["y"]=253,["x"]=289},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}

    return self.我方位置
  elseif 敌我 == false then
    self.敌方位置={[1]={["y"]=180,["x"]=185},[3]={["y"]=150,["x"]=245},[2]={["y"]=210,["x"]=125},[4]={["y"]=240,["x"]=65},[5]={["y"]=120,["x"]=305},[6]={["y"]=220+10,["x"]=230+20+10},[7]={["y"]=250+10,["x"]=170+20+10},[8]={["y"]=190+10,["x"]=290+20+10},[9]={["y"]=280+10,["x"]=110+20+10},[10]={["y"]=160+10,["x"]=350+20+10}}

    --self.敌方位置={[1]={["y"]=180,["x"]=185},[3]={["y"]=150,["x"]=245},[2]={["y"]=210,["x"]=125},[4]={["y"]=240,["x"]=65},[5]={["y"]=120,["x"]=305},[6]={["y"]=220,["x"]=230},[7]={["y"]=250,["x"]=170},[8]={["y"]=190,["x"]=290},[9]={["y"]=280,["x"]=110},[10]={["y"]=160,["x"]=350}}
    self.我方位置={[3]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-155},[1]={["y"]=全局游戏高度-175,["x"]=全局游戏宽度-215},[5]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-95},[2]={["y"]=全局游戏高度-145,["x"]=全局游戏宽度-275},[4]={["y"]=全局游戏高度-115,["x"]=全局游戏宽度-335},[8]={["y"]=全局游戏高度-265,["x"]=全局游戏宽度-225},[6]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-285},[10]={["y"]=全局游戏高度-295,["x"]=全局游戏宽度-165},[7]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-345},[9]={["y"]=全局游戏高度-175,["x"]=全局游戏宽度-405},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}}
    self.阵型位置={}
    self.阵型位置.天覆阵={我方={[3]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-155},[1]={["y"]=全局游戏高度-136,["x"]=全局游戏宽度-172},[5]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-95},[2]={["y"]=全局游戏高度-145,["x"]=全局游戏宽度-275},[4]={["y"]=全局游戏高度-115,["x"]=全局游戏宽度-335},[8]={["y"]=全局游戏高度-265,["x"]=全局游戏宽度-225},[6]={["y"]=全局游戏高度-235,["x"]=全局游戏宽度-285},[10]={["y"]=全局游戏高度-295,["x"]=全局游戏宽度-165},[7]={["y"]=全局游戏高度-205,["x"]=全局游戏宽度-345},[9]={["y"]=全局游戏高度-175,["x"]=全局游戏宽度-405},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=183,["x"]=310},[2]={["y"]=240,["x"]=295},[3]={["y"]=180,["x"]=415},[4]={["y"]=270,["x"]=235},[5]={["y"]=150,["x"]=475},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.云垂阵={我方={[1]={["y"]=全局游戏高度-131,["x"]=全局游戏宽度-142},[2]={["y"]=全局游戏高度-185,["x"]=全局游戏宽度-305},[3]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-185},[4]={["y"]=全局游戏高度-155,["x"]=全局游戏宽度-365},[5]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-125},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=156,["x"]=269},[2]={["y"]=240,["x"]=295},[3]={["y"]=180,["x"]=415},[4]={["y"]=270,["x"]=235},[5]={["y"]=150,["x"]=475},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.风扬阵={我方={[1]={["y"]=全局游戏高度-147,["x"]=全局游戏宽度-174},[2]={["y"]=全局游戏高度-179,["x"]=全局游戏宽度-105},[3]={["y"]=全局游戏高度-104,["x"]=全局游戏宽度-249},[4]={["y"]=全局游戏高度-240,["x"]=全局游戏宽度-181},[5]={["y"]=全局游戏高度-170,["x"]=全局游戏宽度-312},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=189,["x"]=287},[2]={["y"]=214,["x"]=220},[3]={["y"]=143,["x"]=352},[4]={["y"]=248,["x"]=280},[5]={["y"]=191,["x"]=406},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.虎翼阵={我方={[1]={["y"]=全局游戏高度-139,["x"]=全局游戏宽度-129},[2]={["y"]=全局游戏高度-219,["x"]=全局游戏宽度-137},[3]={["y"]=全局游戏高度-144,["x"]=全局游戏宽度-251},[4]={["y"]=全局游戏高度-291,["x"]=全局游戏宽度-135},[5]={["y"]=全局游戏高度-160,["x"]=全局游戏宽度-362},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=142,["x"]=257},[2]={["y"]=209,["x"]=230},[3]={["y"]=146,["x"]=365},[4]={["y"]=275,["x"]=223},[5]={["y"]=160,["x"]=459},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.鸟翔阵={我方={[1]={["y"]=全局游戏高度-192,["x"]=全局游戏宽度-218},[2]={["y"]=全局游戏高度-197,["x"]=全局游戏宽度-86},[3]={["y"]=全局游戏高度-114,["x"]=全局游戏宽度-260},[4]={["y"]=全局游戏高度-289,["x"]=全局游戏宽度-137},[5]={["y"]=全局游戏高度-150,["x"]=全局游戏宽度-382},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=203,["x"]=347},[2]={["y"]=196,["x"]=239},[3]={["y"]=136,["x"]=369},[4]={["y"]=275,["x"]=223},[5]={["y"]=154,["x"]=470},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}} }
    self.阵型位置.地载阵={我方={[1]={["y"]=全局游戏高度-166,["x"]=全局游戏宽度-196},[2]={["y"]=全局游戏高度-218,["x"]=全局游戏宽度-261},[3]={["y"]=全局游戏高度-193,["x"]=全局游戏宽度-137},[4]={["y"]=全局游戏高度-142,["x"]=全局游戏宽度-276},[5]={["y"]=全局游戏高度-105,["x"]=全局游戏宽度-129},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=167,["x"]=306},[2]={["y"]=211,["x"]=355},[3]={["y"]=200,["x"]=242},[4]={["y"]=134,["x"]=376},[5]={["y"]=121,["x"]=251},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.龙飞阵={我方={[1]={["y"]=全局游戏高度-162,["x"]=全局游戏宽度-197},[2]={["y"]=全局游戏高度-118,["x"]=全局游戏宽度-140},[3]={["y"]=全局游戏高度-283,["x"]=全局游戏宽度-142},[4]={["y"]=全局游戏高度-191,["x"]=全局游戏宽度-332},[5]={["y"]=全局游戏高度-216,["x"]=全局游戏宽度-254},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=174,["x"]=277},[2]={["y"]=124,["x"]=215},[3]={["y"]=269,["x"]=223},[4]={["y"]=168,["x"]=407},[5]={["y"]=212,["x"]=330},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.蛇蟠阵={我方={[1]={["y"]=全局游戏高度-162,["x"]=全局游戏宽度-197},[2]={["y"]=全局游戏高度-125,["x"]=全局游戏宽度-268},[3]={["y"]=全局游戏高度-182,["x"]=全局游戏宽度-130},[4]={["y"]=全局游戏高度-191,["x"]=全局游戏宽度-332},[5]={["y"]=全局游戏高度-95,["x"]=全局游戏宽度-124},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=174,["x"]=277},[2]={["y"]=132,["x"]=351},[3]={["y"]=218,["x"]=201},[4]={["y"]=168,["x"]=407},[5]={["y"]=128,["x"]=223},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.鹰啸阵={我方={[1]={["y"]=全局游戏高度-162,["x"]=全局游戏宽度-137},[2]={["y"]=全局游戏高度-186,["x"]=全局游戏宽度-267},[3]={["y"]=全局游戏高度-249,["x"]=全局游戏宽度-131},[4]={["y"]=全局游戏高度-214,["x"]=全局游戏宽度-202},[5]={["y"]=全局游戏高度-98,["x"]=全局游戏宽度-64},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-255},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-315},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-195},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-375},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-725},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=174,["x"]=277},[2]={["y"]=168,["x"]=408},[3]={["y"]=247,["x"]=274},[4]={["y"]=211,["x"]=341},[5]={["y"]=128,["x"]=223},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}
    self.阵型位置.雷绝阵={我方={[1]={["y"]=全局游戏高度-121,["x"]=全局游戏宽度-116},[2]={["y"]=全局游戏高度-123,["x"]=全局游戏宽度-245},[3]={["y"]=全局游戏高度-201,["x"]=全局游戏宽度-97},[4]={["y"]=全局游戏高度-185,["x"]=全局游戏宽度-319},[5]={["y"]=全局游戏高度-251,["x"]=全局游戏宽度-187},[6]={["y"]=全局游戏高度-275,["x"]=全局游戏宽度-315},[7]={["y"]=全局游戏高度-245,["x"]=全局游戏宽度-375},[8]={["y"]=全局游戏高度-305,["x"]=全局游戏宽度-255},[9]={["y"]=全局游戏高度-215,["x"]=全局游戏宽度-435},[10]={["y"]=全局游戏高度-335,["x"]=全局游戏宽度-195},[11]={["y"]=360,["x"]=540},[12]={["y"]=400,["x"]=420},[13]={["y"]=320,["x"]=625},[14]={["y"]=485,["x"]=390},[15]={["y"]=285,["x"]=725}},
    敌方={[1]={["y"]=130,["x"]=234},[2]={["y"]=131,["x"]=335},[3]={["y"]=201,["x"]=234},[4]={["y"]=170,["x"]=401},[5]={["y"]=253,["x"]=289},[6]={["y"]=250,["x"]=400},[7]={["y"]=280,["x"]=340},[8]={["y"]=220,["x"]=460},[9]={["y"]=310,["x"]=280},[10]={["y"]=190,["x"]=520}}}

    return self.敌方位置

  end

end

function 战斗类:更新(dt,x,y)
  for n=1,#self.战斗单位 do
    self.战斗单位[n]:更新(dt)
    if self.战斗单位[n]:是否选中(x,y) and 引擎.鼠标弹起(右键)  then
      self.战斗单位[n]:设置鼠标跟随()
    end
  end
  if 引擎.鼠标弹起(0x2) and 1==2 then
    local 敌方位置={}
    local 我方位置={}
    for n=1,#self.战斗单位 do
      if self.战斗单位[n].敌我==1 then
        我方位置[self.战斗单位[n].数据.位置]={x=self.战斗单位[n].显示xy.x,y=self.战斗单位[n].显示xy.y}
      else
        敌方位置[self.战斗单位[n].数据.位置]={x=self.战斗单位[n].显示xy.x,y=self.战斗单位[n].显示xy.y}
      end
    end
  end
  if self.进程=="命令" then
    self.战斗指令:更新(dt,x,y)
  end
  if self.进程=="计算" and self.战斗流程~=nil and self.战斗流程[1]~=nil then
    if self.战斗流程[1].允许==false then
      if self.战斗流程[1].提示==nil or self.战斗流程[1].提示.允许==false  then
        self.战斗流程[1].可以执行=true
      elseif self.战斗流程[1].提示.类型=="法术" and self.战斗流程[1].可以执行==nil then
        if self.战斗流程[1].特技名称==nil  then
          if self.战斗流程[1].提示.允许 then
            self:添加战斗提醒文字(self.战斗流程[1].提示.名称)
          end
        elseif  self.战斗流程[1].提示.允许 then
          self.战斗单位[self.战斗流程[1].攻击方]:添加特技内容(self.战斗流程[1].特技名称)
        end
        self.战斗流程[1].可以执行=true
      end
    end
    if self.战斗流程[1].可以执行 and self.战斗单位[self.战斗流程[1].攻击方] ~= nil and self.战斗单位[self.战斗流程[1].攻击方].特技内容开关==false then
      self.战斗流程[1].允许=true
      self.执行流程=self.战斗流程[1].流程
      self.进程="执行"
    end
  elseif self.进程=="执行" then
    self:流程更新()
    -- print("流程更新结束")
    -- print("流程更新结束"..self.拼接特效)
    if self.拼接特效 ~= nil then
      for n=1,#self.拼接特效 do
        if self.拼接特效[n]~=nil then
          dt=tp.战斗加速*dt+dt
          self.拼接特效[n].特效:更新(dt*self.全屏加速)
          -- print("self.拼接特效[n].特效.当前帧"..self.拼接特效[n].特效.当前帧)
          -- print("self.拼接特效[n].特效.结束帧"..self.拼接特效[n].特效.结束帧)
          if self.拼接特效[n].特效.当前帧>=self.拼接特效[n].特效.结束帧 then
            table.remove(self.拼接特效,n)
            -- print("remove")
          end
        end
      end
      if #self.拼接特效==self.掉血流程 then self.掉血流程=nil
        -- print("掉血流程-----------"..掉血流程)
      end
      -- print("掉血流程-----------")
      if #self.拼接特效==0 then self.拼接特效=nil self.背景状态=nil
        -- print("拼接特效-----------"..拼接特效)
        -- print("背景状态-----------"..背景状态)
        end

    end
  end
end

function 战斗类:流程更新()
  print(self.执行流程)
  if self.战斗流程[1]==nil then
  end
  if self.执行流程==1 and self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:取状态() and self.战斗单位[self.战斗流程[1].攻击方]:取状态()  then -- 攻击
    self.战斗单位[self.战斗流程[1].攻击方].移动开关=true
    self.战斗单位[self.战斗流程[1].攻击方].移动坐标.x,self.战斗单位[self.战斗流程[1].攻击方].移动坐标.y=self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].显示xy.x,self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].显示xy.y
    self.执行流程=2
  elseif self.执行流程==2 and self.战斗单位[self.战斗流程[1].攻击方].移动开关==false then
    if self.战斗流程[1].保护数据==nil then
      self.战斗单位[self.战斗流程[1].攻击方]:换动作("攻击",true,nil,self.战斗流程[1].添加状态,self.战斗流程[1].取消状态,self.战斗流程[1].结尾气血)
      if self.战斗流程[1].挨打方[1].死亡~=nil then
        self.战斗单位[self.战斗流程[1].攻击方].动画:置帧率("攻击",0.11)
      end
      self.执行流程=3
    else
      self.执行流程=10
    end
  elseif self.执行流程==3 then
    if  self.战斗单位[self.战斗流程[1].攻击方]:取间隔() >= self.战斗单位[self.战斗流程[1].攻击方]:取中间()+self.战斗单位[self.战斗流程[1].攻击方].攻击帧  then
      if self.战斗流程[1].躲避 then
        self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:开启躲避()
        self.执行流程=7
      else
        self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:换动作(self.战斗流程[1].挨打方[1].动作,nil,true,self.战斗流程[1].挨打方[1].添加状态,self.战斗流程[1].挨打方[1].取消状态)
        self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:开启击退(self.战斗流程[1].挨打方[1].死亡)
        self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:设置掉血(self.战斗流程[1].挨打方[1].伤害,self.战斗流程[1].挨打方[1].伤害类型)
        if self.战斗流程[1].挨打方[1].取消状态~=nil then
          self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].状态特效[self.战斗流程[1].挨打方[1].取消状态]=nil
        end
        if self.战斗流程[1].挨打方[1].增加状态~=nil then
          self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:增加状态(self.战斗流程[1].挨打方[1].增加状态)
        end
        for n=1,#self.战斗流程[1].挨打方[1].特效 do
          self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:添加攻击特效(self.战斗流程[1].挨打方[1].特效[n])
        end
        if self.战斗流程[1].吸血伤害~=nil then
          self.战斗单位[self.战斗流程[1].攻击方]:设置掉血(self.战斗流程[1].吸血伤害,2)
        end
        if self.战斗流程[1].反震伤害~=nil then
          self.战斗单位[self.战斗流程[1].攻击方]:换动作("挨打",nil,true)
          self.战斗单位[self.战斗流程[1].攻击方]:设置掉血(self.战斗流程[1].反震伤害,1)
          self.战斗单位[self.战斗流程[1].攻击方]:开启击退(self.战斗流程[1].反震死亡)
          self.执行流程=8
        else
          self.执行流程=17
        end
      end
    end
  elseif self.执行流程==4 and ((self.战斗流程[1].挨打方[1]==nil or self.战斗流程[1].挨打方[1].挨打方==nil or self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]==nil) or self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:取状态()) then
    if self.战斗流程[1].反击伤害~=nil then
      if self.战斗流程[1].反击死亡~=nil then
        self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].动画:置帧率("攻击",0.11)
      end
      self.执行流程=16
    elseif self.战斗流程[1].返回 then
      self.战斗单位[self.战斗流程[1].攻击方].返回开关=true
      self.战斗单位[self.战斗流程[1].攻击方].移动坐标.x,self.战斗单位[self.战斗流程[1].攻击方].移动坐标.y=self.战斗单位[self.战斗流程[1].攻击方].初始xy.x,self.战斗单位[self.战斗流程[1].攻击方].初始xy.y
      self.执行流程=5
    else
      self.执行流程=6
    end
  elseif self.执行流程==5 and self.战斗单位[self.战斗流程[1].攻击方]:取状态() then
    self.战斗单位[self.战斗流程[1].攻击方]:换方向(self.战斗单位[self.战斗流程[1].攻击方].初始方向)
    self.执行流程=6
  elseif self.执行流程==6 then
    for n=1,#self.战斗单位 do
      if #self.战斗流程==1 and self.战斗单位[n]:取状态()==false then return  end
    end
    table.remove(self.战斗流程,1)
    self.执行流程=0
    self.进程="计算"
    if #self.战斗流程==0 then
      self.进程="等待"
      发送数据(5503)
    end
  elseif self.执行流程==7 and self.战斗单位[self.战斗流程[1].攻击方].动作=="待战"  then
    self.执行流程=4
  elseif self.执行流程==8 and self.战斗单位[self.战斗流程[1].攻击方]:取状态() and self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:取状态() then
    if self.战斗流程[1].反震死亡==nil  then
      self.执行流程=4
    else
      self.执行流程=6
    end
  elseif self.执行流程==9 and self.战斗单位[self.战斗流程[1].攻击方]:取状态() and self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:取状态() then
    if self.战斗流程[1].反击死亡==nil  then
      self.战斗流程[1].反击伤害=nil
      self.执行流程=4
    else
      self.执行流程=6
    end
  elseif self.执行流程==10 then -- 攻击
    self.战斗单位[self.战斗流程[1].保护数据.编号].移动开关=true
    self.战斗单位[self.战斗流程[1].保护数据.编号].移动坐标.x,self.战斗单位[self.战斗流程[1].保护数据.编号].移动坐标.y=self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].显示xy.x,self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].显示xy.y
    self.战斗单位[self.战斗流程[1].保护数据.编号]:添加攻击特效("保护")
    self.执行流程=11
  elseif self.执行流程==11 and self.战斗单位[self.战斗流程[1].保护数据.编号].移动开关==false then
    self.战斗单位[self.战斗流程[1].攻击方]:换动作("攻击",true,nil,self.战斗流程[1].添加状态,self.战斗流程[1].取消状态,self.战斗流程[1].结尾气血)
    if self.战斗流程[1].挨打方[1].死亡~=nil then
      self.战斗单位[self.战斗流程[1].攻击方].动画:置帧率("攻击",0.11)
    end
    self.执行流程=12
  elseif self.执行流程==12 then
    if  self.战斗单位[self.战斗流程[1].攻击方]:取间隔() >= self.战斗单位[self.战斗流程[1].攻击方]:取中间()+self.战斗单位[self.战斗流程[1].攻击方].攻击帧  then
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:换动作(self.战斗流程[1].挨打方[1].动作,nil,true,self.战斗流程[1].挨打方[1].添加状态,self.战斗流程[1].挨打方[1].取消状态)
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:开启击退(self.战斗流程[1].挨打方[1].死亡)
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:设置掉血(self.战斗流程[1].挨打方[1].伤害,self.战斗流程[1].挨打方[1].伤害类型)
      self.战斗单位[self.战斗流程[1].保护数据.编号]:换动作("挨打",nil,true)
      self.战斗单位[self.战斗流程[1].保护数据.编号]:开启击退(self.战斗流程[1].保护数据.死亡)
      self.战斗单位[self.战斗流程[1].保护数据.编号]:设置掉血(self.战斗流程[1].保护数据.伤害,self.战斗流程[1].挨打方[1].伤害类型)
      for n=1,#self.战斗流程[1].挨打方[1].特效 do
        self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:添加攻击特效(self.战斗流程[1].挨打方[1].特效[n])
      end
      if self.战斗流程[1].吸血伤害~=nil then
        self.战斗单位[self.战斗流程[1].攻击方]:设置掉血(self.战斗流程[1].吸血伤害,2)
      end
      self.执行流程=13
    end
  elseif self.执行流程==13 and self.战斗单位[self.战斗流程[1].攻击方]:取状态() and self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:取状态() and self.战斗单位[self.战斗流程[1].保护数据.编号]:取状态() then
    if self.战斗流程[1].保护数据.死亡~=nil then
      self.执行流程=4
    else
      self.执行流程=14
    end
  elseif self.执行流程==14 then
     self.战斗单位[self.战斗流程[1].保护数据.编号].返回开关=true
     self.战斗单位[self.战斗流程[1].保护数据.编号].移动坐标.x,self.战斗单位[self.战斗流程[1].保护数据.编号].移动坐标.y=self.战斗单位[self.战斗流程[1].保护数据.编号].初始xy.x,self.战斗单位[self.战斗流程[1].保护数据.编号].初始xy.y
     self.执行流程=15
  elseif self.执行流程==15 then
    self.执行流程=4
  elseif self.执行流程==16 then
    if self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:取间隔() >= self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:取中间()+self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].攻击帧  then
      self.战斗单位[self.战斗流程[1].攻击方]:换动作("挨打",nil,true)
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:换动作("攻击",true,nil)
      self.战斗单位[self.战斗流程[1].攻击方]:设置掉血(self.战斗流程[1].反击伤害,1)
      self.战斗单位[self.战斗流程[1].攻击方]:开启击退(self.战斗流程[1].反击死亡)
      self.战斗单位[self.战斗流程[1].攻击方]:添加攻击特效("被击中")
      self.执行流程=9
    end
  elseif self.执行流程==17 and self.战斗单位[self.战斗流程[1].攻击方]:取状态() and self.战斗单位[self.战斗流程[1].攻击方].动作~="攻击" then
    if self.战斗流程[1].反击伤害~=nil then
      self.执行流程=4
    elseif self.战斗流程[1].返回 then
     self.战斗单位[self.战斗流程[1].攻击方].返回开关=true
     self.战斗单位[self.战斗流程[1].攻击方].移动坐标.x,self.战斗单位[self.战斗流程[1].攻击方].移动坐标.y=self.战斗单位[self.战斗流程[1].攻击方].初始xy.x,self.战斗单位[self.战斗流程[1].攻击方].初始xy.y
     self.执行流程=5
    else
     self.执行流程=6
    end
  elseif self.执行流程==50 then
    self.战斗单位[self.战斗流程[1].攻击方]:换动作("施法",true)
    self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:添加法术特效(self.战斗流程[1].挨打方[1].特效[1])
    self.执行流程=51
  elseif self.执行流程==51 and #self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].法术特效==0 then
    self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:增加状态(self.战斗流程[1].挨打方[1].添加状态)
    self.执行流程=52
  elseif self.执行流程==52 and self.战斗单位[self.战斗流程[1].攻击方].动作=="待战" then
    self.执行流程=6
  elseif self.执行流程==53 then
    self.战斗单位[self.战斗流程[1].攻击方]:换动作("施法",true)
    for n=1,#self.战斗流程[1].挨打方 do
      -- print(self.战斗流程[1].挨打方[n].特效[1],11)
      self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:添加法术特效(self.战斗流程[1].挨打方[n].特效[1])
    end
    self.执行流程=54
  elseif self.执行流程==54 and #self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].法术特效==0 then
    for n=1,#self.战斗流程[1].挨打方 do
      self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:增加状态(self.战斗流程[1].挨打方[n].特效[1])
      if self.战斗流程[1].挨打方[n].恢复气血~=nil then
       self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:设置掉血(self.战斗流程[1].挨打方[n].恢复气血,2)
      end
    end
    self.执行流程=55
  elseif self.执行流程==55 and self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].掉血开关==false and self.战斗单位[self.战斗流程[1].攻击方].动作=="待战"  then
    self.执行流程=6
  elseif self.执行流程==56 then
    self.战斗单位[self.战斗流程[1].攻击方]:换动作("施法",true)
    for n=1,#self.战斗流程[1].挨打方 do
      -- print(self.战斗流程[1].挨打方[n].特效[1],11)
      self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:添加法术特效(self.战斗流程[1].挨打方[n].特效[1])
    end
   self.执行流程=57
  elseif self.执行流程==57 and #self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].法术特效==0 then
    if self.战斗流程[1].挨打方[1].气血~=nil then
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:设置掉血(self.战斗流程[1].挨打方[1].气血,1)
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:换动作("挨打",nil,true)
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:开启击退(self.战斗流程[1].挨打方[1].死亡)
    elseif self.战斗流程[1].挨打方[1].击退~=nil then
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:换动作("挨打",nil,true)
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:开启击退(nil)
    end
    if self.战斗流程[1].受益方 ~= nil then
      for i=1,#self.战斗流程[1].受益方 do
        if self.战斗流程[1].受益方[i] ~= nil then
          self.战斗单位[self.战斗流程[1].受益方[i].受益方]:设置掉血(self.战斗流程[1].受益方[i].伤害,2)
        end
      end
    end
    self.执行流程=58
  elseif self.执行流程==58 and self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:取状态() then
    if self.战斗流程[1].挨打方[1].状态~=nil then
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:增加状态(self.战斗流程[1].挨打方[1].状态)
    end
    if self.战斗流程[1].增加气血~=nil then
     self.战斗单位[self.战斗流程[1].攻击方]:设置掉血(self.战斗流程[1].增加气血,2)
    end
    self.执行流程=59
  elseif self.执行流程==59 and self.战斗单位[self.战斗流程[1].攻击方]:取状态() then
    self.执行流程=6
  elseif self.执行流程==60 then
    self.战斗单位[self.战斗流程[1].攻击方]:换动作("施法",true)
    for n=1,#self.战斗流程[1].挨打方 do
      self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:添加法术特效(self.战斗流程[1].挨打方[n].特效[1])
    end
    if self.战斗流程[1].扣除气血~=nil then
      self.执行流程=63
      -- self.战斗单位[self.战斗流程[1].攻击方]:设置掉血(self.战斗流程[1].挨打方[n].恢复气血,1)
    else
      self.执行流程=61
    end
  elseif self.执行流程==61 and #self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].法术特效==0 then
    for n=1,#self.战斗流程[1].挨打方 do
      for i=1,#self.战斗流程[1].挨打方[n].解除状态 do
        -- table.print(self.战斗单位[self.战斗流程[1].挨打方[n].挨打方])
        self.战斗单位[self.战斗流程[1].挨打方[n].挨打方].状态特效[self.战斗流程[1].挨打方[n].解除状态[i]]=nil
       end
      if self.战斗流程[1].挨打方[n].恢复气血~=nil then
       self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:设置掉血(self.战斗流程[1].挨打方[n].恢复气血,2)
      end
      if self.战斗流程[1].挨打方[n].复活~=nil then
        self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:换动作("待战")
        self.战斗单位[self.战斗流程[1].挨打方[n].挨打方].停止更新=false
      end
      if self.战斗流程[1].挨打方[n].添加状态~=nil then
        self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:增加状态(self.战斗流程[1].挨打方[n].添加状态)
      end
    end
    self.执行流程=62
  elseif  self.执行流程==62 then
    local 条件通过=#self.战斗流程[1].挨打方
    for n=1,#self.战斗流程[1].挨打方 do
      if self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:取状态() then
        条件通过=条件通过-1
      end
    end
    if 条件通过<=0 then
      self.执行流程=6
    end
  elseif  self.执行流程==63 and self.战斗单位[self.战斗流程[1].攻击方].动作=="待战" then
    self.战斗单位[self.战斗流程[1].攻击方]:设置掉血(self.战斗流程[1].扣除气血,1)
    self.执行流程=64
  elseif self.执行流程==64 and self.战斗单位[self.战斗流程[1].攻击方]:取状态() then
   self.执行流程=61
  elseif self.执行流程==100 then
    self.战斗单位[self.战斗流程[1].攻击方]:设置掉血(self.战斗流程[1].气血,2)
    self.执行流程=101
  elseif self.执行流程==101 and self.战斗单位[self.战斗流程[1].攻击方].掉血开关==false then
    self.执行流程=6
  elseif self.执行流程==102 then
    self.战斗单位[self.战斗流程[1].攻击方]:设置掉血(self.战斗流程[1].气血,1)
    self.战斗单位[self.战斗流程[1].攻击方]:换动作("挨打",nil,true)
    self.战斗单位[self.战斗流程[1].攻击方]:开启击退(self.战斗流程[1].死亡)
    if self.战斗流程[1].受益方 ~= nil and #self.战斗流程[1].受益方 >0 then
      for i=1,#self.战斗流程[1].受益方 do
        if self.战斗流程[1].受益方[i] ~= nil then
          self.战斗单位[self.战斗流程[1].受益方[i].受益方]:设置掉血(self.战斗流程[1].受益方[i].伤害,2)
        end
      end
    end
    self.执行流程=103
  elseif self.执行流程==103 and self.战斗单位[self.战斗流程[1].攻击方]:取状态() then
    self.执行流程=6
  elseif self.执行流程==104 then
    self.战斗单位[self.战斗流程[1].挨打方.挨打方]:设置掉血(self.战斗流程[1].气血,1)
    self.执行流程=105
  elseif self.执行流程==105 and self.战斗单位[self.战斗流程[1].挨打方.挨打方].掉血开关==false then
    if self.战斗流程[1].挨打方.死亡~=nil then
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:死亡处理1(self.战斗流程[1].挨打方[1].死亡)
      self.执行流程=106
    else
     self.执行流程=6
    end
  elseif self.执行流程==106 and self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].死亡开关==false then
    self.执行流程=6
  elseif self.执行流程==200 then
    for n=1,#self.战斗流程[1].挨打方 do
      if self.战斗流程[1].挨打方[n].挨打方==nil or self.战斗流程[1].挨打方[n].挨打方==0 or self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]==nil then
       table.remove(self.战斗流程[1].挨打方,n)
      end
    end
    self.战斗单位[self.战斗流程[1].攻击方]:换动作("施法",true)
    for n=1,#self.战斗流程[1].挨打方 do
      if self.战斗流程[1].吸血伤害~=nil then
        self.战斗单位[self.战斗流程[1].攻击方]:设置掉血(self.战斗流程[1].吸血伤害,2)
      end
      self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:添加法术特效(self.战斗流程[1].挨打方[n].特效[1])
      if self.战斗流程[1].挨打方[n].特效[2]~=nil then
        self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:添加攻击特效(self.战斗流程[1].挨打方[n].特效[2])
      end
    end
    if #self.战斗流程[1].挨打方 <= 0 then
      self.执行流程=6
    else
      self.执行流程=201
    end
  elseif self.执行流程==201 and  #self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].法术特效==0 then
    for n=1,#self.战斗流程[1].挨打方 do
      self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:设置掉血(self.战斗流程[1].挨打方[n].伤害,self.战斗流程[1].挨打方[n].类型)
      self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:换动作("挨打",nil,true)
      self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:开启击退(self.战斗流程[1].挨打方[n].死亡)
      if self.战斗流程[1].挨打方[n].取消状态~=nil then
        self.战斗单位[self.战斗流程[1].挨打方[n].挨打方].状态特效[self.战斗流程[1].挨打方[n].取消状态]=nil
      end
    end
    self.执行流程=202
  elseif self.执行流程==202 then
   local 条件通过=#self.战斗流程[1].挨打方
   for n=1,#self.战斗流程[1].挨打方 do
      if self.战斗流程[1].挨打方[n] ~= nil and self.战斗流程[1].挨打方[n].挨打方 ~= nil and self.战斗单位[self.战斗流程[1].挨打方[n].挨打方] ~= nil and self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:取状态() then
        条件通过=条件通过-1
        end
      end
     if 条件通过<=0 then
       self.执行流程=203
       end
 elseif self.执行流程==203 then
   for n=1,#self.战斗流程[1].挨打方 do
      if self.战斗流程[1].挨打方[n].状态~=nil  then
        self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:增加状态(self.战斗流程[1].挨打方[n].状态)
        end
      end
    self.执行流程=204
  elseif self.执行流程==204 then
   self.执行流程=6
  elseif self.执行流程==205 then
    print("置全屏特效开始")
   self:置全屏特效(self.战斗流程[1].挨打方[1].特效[1],self.战斗单位[self.战斗流程[1].挨打方[1].挨打方])
   print("置全屏特效结束")
   self.战斗单位[self.战斗流程[1].攻击方]:换动作("施法",true)
   print("换动作结束")
   self.执行流程=206
   elseif self.执行流程==206  and self.掉血流程==nil and  self.战斗单位[self.战斗流程[1].攻击方].动作=="待战" then
      self.执行流程=201
   elseif self.执行流程==207 then
     self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:增加状态(self.战斗流程[1].挨打方[1].增加状态)
     self.执行流程=6
   elseif self.执行流程==300 then
     self.战斗单位[self.战斗流程[1].攻击方]:设置抓捕动画(self.战斗流程[1].挨打方[1].挨打方,self.战斗流程[1].宝宝,self.战斗流程[1].捕捉成功,self.战斗流程[1].名称)
     self.执行流程=301
    elseif self.执行流程==301 and  self.战斗单位[self.战斗流程[1].攻击方].抓捕开关==false then
      self.执行流程=6
   elseif self.执行流程==400 then
     self.战斗单位[self.战斗流程[1].攻击方]:换动作("施法",true)
     self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:添加法术特效(self.战斗流程[1].挨打方[1].特效[1])
     self.执行流程=401
    elseif self.执行流程==401 and #self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].法术特效==0 then
     for n=1,#self.战斗流程[1].挨打方[1].特效 do
        if self.战斗流程[1].挨打方[1].特效[n]=="满天花雨" then
         self.战斗流程[1].挨打方[1].特效[n]="被击中"
          end
       end
      self.执行流程=1
   elseif self.执行流程==500 then
     self.战斗单位[self.战斗流程[1].攻击方]:设置掉血(self.战斗流程[1].伤害,1)
     self.执行流程=501
    elseif self.执行流程==501 and self.战斗单位[self.战斗流程[1].攻击方]:取状态() then
        self.战斗单位[self.战斗流程[1].攻击方]:换动作("施法",true)
     for n=1,#self.战斗流程[1].挨打方 do
       -- print(self.战斗流程[1].挨打方[n].特效[1],11)
        self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:添加法术特效(self.战斗流程[1].挨打方[n].特效[1])
        if self.战斗流程[1].挨打方[n].特效[2]~=nil then
          self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:添加攻击特效(self.战斗流程[1].挨打方[n].特效[2])
         end
       end
     self.执行流程=502
   elseif self.执行流程==502 and #self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].法术特效==0 then
    for n=1,#self.战斗流程[1].挨打方 do
      self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:设置掉血(self.战斗流程[1].挨打方[n].伤害,self.战斗流程[1].挨打方[n].类型)
      self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:换动作("挨打",nil,true)
      self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:开启击退(self.战斗流程[1].挨打方[n].死亡)
      if self.战斗流程[1].挨打方[n].取消状态~=nil then
         self.战斗单位[self.战斗流程[1].挨打方[n].挨打方].状态特效[self.战斗流程[1].挨打方[n].取消状态]=nil
        end
      end
    self.执行流程=503
 elseif self.执行流程==503 then
   local 条件通过=#self.战斗流程[1].挨打方
   for n=1,#self.战斗流程[1].挨打方 do
      if self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:取状态() then
        条件通过=条件通过-1
        end
      end
     if 条件通过<=0 then
       self.执行流程=504
       end
 elseif self.执行流程==504 then
   for n=1,#self.战斗流程[1].挨打方 do
      if self.战斗流程[1].挨打方[n].状态~=nil  then
        self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:增加状态(self.战斗流程[1].挨打方[n].状态)
        end
      end
    self.执行流程=505
  elseif self.执行流程==505 then
    self.战斗单位[self.战斗流程[1].攻击方].是否显示=false
   self.执行流程=6
   elseif self.执行流程==900 then
    if self.战斗流程[1].id==tp.队伍[1].数字id or self.战斗流程[1].id==0 then
      tp.提示:写入(self.战斗流程[1].内容)
      end
   self.执行流程=6
   elseif self.执行流程==901 then
    if self.战斗流程[1].id==tp.队伍[1].数字id or self.战斗流程[1].id==0 then
      tp.窗口.消息框:添加文本(self.战斗流程[1].内容)
      end
   self.执行流程=6
   elseif self.执行流程==600 then
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]=战斗单位类()
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:创建单位(self.战斗流程[1].挨打方[1].数据,self.战斗流程[1].挨打方[1].队伍,self.战斗流程[1].挨打方[1].挨打方)
      self.执行流程=6
    elseif self.执行流程==601 then
      self.战斗单位[self.战斗流程[1].攻击方].方向=self.战斗单位[self.战斗流程[1].攻击方].逃跑方向
      self.战斗单位[self.战斗流程[1].攻击方]:换动作("返回")
     -- self.战斗单位[self.战斗流程[1].攻击方].逃跑开关=true
      self.战斗流程[1].等待计时=时间
      self.执行流程=602
    elseif self.执行流程==602 and 时间-self.战斗流程[1].等待计时>=3 then
      if self.战斗流程[1].成功==false then
       self.执行流程=603
      else
        self.执行流程=605
        self.战斗单位[self.战斗流程[1].攻击方].逃跑开关=true
        if self.战斗流程[1].追加~=nil then
         self.战斗单位[self.战斗流程[1].追加].方向=self.战斗单位[self.战斗流程[1].追加].逃跑方向
         self.战斗单位[self.战斗流程[1].追加]:换动作("返回")
         self.战斗单位[self.战斗流程[1].追加].逃跑开关=true
          end
        end
   elseif self.执行流程==603 then
      self.战斗流程[1].等待计时=时间
      self.战斗流程[1].初始方向=self.战斗单位[self.战斗流程[1].攻击方].逃跑方向
      self.战斗单位[self.战斗流程[1].攻击方]:换动作("待战")
      self.执行流程=604
    elseif self.执行流程==604 then
      self.战斗流程[1].初始方向=self.战斗流程[1].初始方向+1
      if self.战斗流程[1].初始方向>=4 then self.战斗流程[1].初始方向=0 end
      self.战斗单位[self.战斗流程[1].攻击方].方向=self.战斗流程[1].初始方向
      self.战斗单位[self.战斗流程[1].攻击方]:换动作("待战")
      if 时间-self.战斗流程[1].等待计时>=1 then
        self.战斗单位[self.战斗流程[1].攻击方].方向=self.战斗单位[self.战斗流程[1].攻击方].初始方向
        self.战斗单位[self.战斗流程[1].攻击方]:换动作("待战")
        self.执行流程=6
        end
  elseif self.执行流程==605 then
     self.战斗单位[self.战斗流程[1].攻击方].显示xy.x=self.战斗单位[self.战斗流程[1].攻击方].显示xy.x+self.战斗单位[self.战斗流程[1].攻击方].逃跑坐标
     self.战斗单位[self.战斗流程[1].攻击方].显示xy.y=self.战斗单位[self.战斗流程[1].攻击方].显示xy.y+self.战斗单位[self.战斗流程[1].攻击方].逃跑坐标
    if self.战斗流程[1].追加==nil then
      if 取两点距离(生成XY(self.战斗单位[self.战斗流程[1].攻击方].显示xy.x,self.战斗单位[self.战斗流程[1].攻击方].显示xy.y),生成XY(self.战斗单位[self.战斗流程[1].攻击方].初始xy.x,self.战斗单位[self.战斗流程[1].攻击方].初始xy.y))>=500 then
       self.执行流程=606
        end
   else
     self.战斗单位[self.战斗流程[1].追加].显示xy.x=self.战斗单位[self.战斗流程[1].追加].显示xy.x+self.战斗单位[self.战斗流程[1].追加].逃跑坐标
     self.战斗单位[self.战斗流程[1].追加].显示xy.y=self.战斗单位[self.战斗流程[1].追加].显示xy.y+self.战斗单位[self.战斗流程[1].追加].逃跑坐标
     if 取两点距离(生成XY(self.战斗单位[self.战斗流程[1].攻击方].显示xy.x,self.战斗单位[self.战斗流程[1].攻击方].显示xy.y),生成XY(self.战斗单位[self.战斗流程[1].攻击方].初始xy.x,self.战斗单位[self.战斗流程[1].攻击方].初始xy.y))>=500 and 取两点距离(生成XY(self.战斗单位[self.战斗流程[1].追加].显示xy.x,self.战斗单位[self.战斗流程[1].追加].显示xy.y),生成XY(self.战斗单位[self.战斗流程[1].追加].初始xy.x,self.战斗单位[self.战斗流程[1].追加].初始xy.y))>=500 then
       self.执行流程=606
        end
     end
   elseif self.执行流程==606 then
      self.战斗单位[self.战斗流程[1].攻击方].是否显示=false
      if self.战斗流程[1].结束 and tp.队伍[1].数字id==self.战斗流程[1].id then
        发送数据(5506)
        self.执行流程=999999
      else
        self.执行流程=6
      end
    elseif self.执行流程==607 then
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]=战斗单位类()
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方]:创建单位(self.战斗流程[1].挨打方[1].数据,self.战斗流程[1].挨打方[1].队伍,self.战斗流程[1].挨打方[1].挨打方)
      self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].是否显示=false
      self.战斗单位[self.战斗流程[1].攻击方]:换动作("施法",true)
      self:添加战斗提醒文字(self.战斗单位[self.战斗流程[1].攻击方].名称.."使用了召唤")
      self.执行流程=608
   elseif self.执行流程==608 then
      if self.战斗单位[self.战斗流程[1].攻击方].动作=="待战" then
        self.战斗单位[self.战斗流程[1].挨打方[1].挨打方].是否显示=true
        self.执行流程=609
        self.战斗流程[1].延时等待=时间
        end
  elseif self.执行流程==609 and 时间-self.战斗流程[1].延时等待>=1 then
     self.执行流程=6
   elseif self.执行流程==610 then
      self.战斗单位[self.战斗流程[1].攻击方].状态特效[self.战斗流程[1].状态]=nil
      self.执行流程=6
   elseif self.执行流程==611 then
     if #self.战斗流程[1].挨打方==0 then
       self.执行流程=6
      else
       self.战斗单位[self.战斗流程[1].攻击方]:换动作("施法",true)
       for n=1,#self.战斗流程[1].挨打方 do
         self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:设置飞镖(self.战斗单位[self.战斗流程[1].攻击方].显示xy,self.战斗单位[self.战斗流程[1].攻击方].初始方向,self.战斗流程[1].挨打方[n].伤害,self.战斗流程[1].挨打方[n].死亡)
          end
        self.执行流程=612
       end
   elseif self.执行流程==612 then
     local 结束=true
     for n=1,#self.战斗流程[1].挨打方 do
        if self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:取状态()==false then
         结束=false
          end
        end
    if 结束 then
      for n=1,#self.战斗流程[1].挨打方 do
        if self.战斗流程[1].挨打方[n].增加状态~=nil then
          self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:增加状态(self.战斗流程[1].挨打方[n].增加状态)
        end
      end
     self.执行流程=6
    end
  elseif self.执行流程==613 then
    if #self.战斗流程[1].挨打方==0 then
      self.执行流程=6
    else
      for n=1,#self.战斗流程[1].挨打方 do
        self.战斗单位[self.战斗流程[1].挨打方[n].挨打方]:设置溅射(self.战斗单位[self.战斗流程[1].攻击方].显示xy,self.战斗单位[self.战斗流程[1].攻击方].初始方向,self.战斗流程[1].挨打方[n].伤害,self.战斗流程[1].挨打方[n].死亡)
      end
      self.执行流程=612
    end
  end
end

function 战斗类:置全屏特效(jnm,单位)
  local qp = nil
  self.全屏加速=1.5
  self.掉血流程=0
  --if jnm == "龙卷雨击" then
  -- self.拼接特效 = {}
  --  for s=1,5 do
  --     self.拼接特效[s] = {}
  --     self.拼接特效[s].特效 = 单位:加载特效("龙卷雨击"..s)
  --     self.拼接特效[s].偏移 = {x=0,y=0}
  --    if s == 1 then
  --      self.拼接特效[s].偏移 = {x=-150,y=0}
  --    elseif s == 2 then
  --      self.拼接特效[s].偏移 = {x=50,y=-30}
  --    elseif s == 3 then
  --      self.拼接特效[s].偏移 = {x=-500,y=-500}
  --    elseif s == 4 then
  --      self.拼接特效[s].偏移 = {x=-40,y=-100}
  --    elseif s == 5 then
  --      self.拼接特效[s].偏移 = {x=-40,y=0}
  --    end
  --  end
  -- self.背景状态 = 1
  -- self.掉血流程=3
  -- self.全屏加速=2
  --  qp = true
  --if jnm == "龙卷雨击" then
  --  self.拼接特效 = {}
  --  self.拼接特效[1] = {}
  --  self.拼接特效[1].特效 = 单位:加载特效("龙卷雨击")
  --  self.拼接特效[1].偏移 = {x=0,y=0}
  --  self.全屏加速=1.5
  --  qp = true
  if jnm == "龙吟" then
     self.拼接特效 = {}
      for s=1,5 do
         self.拼接特效[s] = {}
         self.拼接特效[s].特效 = 单位:加载特效("龙吟"..s)
         self.拼接特效[s].偏移 = {x=0,y=0}
        if s == 1 then
         self.拼接特效[s].偏移 = {x=60,y=20}
        elseif s == 2 then
         self.拼接特效[s].偏移 = {x=-10,y=-20}
       -- elseif s == 4 then
         --self.拼接特效[s].偏移 = {x=-40,y=-100}
        end
      end
      --[[self.拼接特效[3] = {}
      self.拼接特效[3].特效 = 单位:加载特效("龙吟")
      self.拼接特效[3].偏移 = {x=-40,y=-100}
 --]]
     self.背景状态 = 1
     self.掉血流程=3
     self.全屏加速=2
      qp = true
    elseif jnm == "飞砂走石" then
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效("飞砂走石")
     self.拼接特效[1].偏移 = {x=0,y=0}
      self.全屏加速=1.5
      qp = true
    elseif jnm == "翻江搅海" then
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效("翻江搅海")
     self.拼接特效[1].偏移 = {x=-40,y=-50}
      qp = true
    elseif jnm == "泰山压顶" then
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效("泰山压顶")
     self.拼接特效[1].偏移 = {x=0,y=0}
      qp = true
    elseif jnm == "叱咤风云" then
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效("叱咤风云")
     self.拼接特效[1].偏移 = {x=-100,y=10}
      qp = true
    elseif jnm == "八凶法阵" then
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效("八凶法阵")
     self.拼接特效[1].偏移 = {x=-100,y=10}
      qp = true
    elseif jnm == "天降灵葫" then
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效("天降灵葫")
     self.拼接特效[1].偏移 = {x=-100,y=20}
      qp = true
    elseif jnm == "巨岩破" then
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效(jnm)
     self.拼接特效[1].偏移 = {x=0,y=0}
      qp = true
    elseif jnm == "日光华" then
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效(jnm)
     self.拼接特效[1].偏移 = {x=0,y=0}
      qp = true
    elseif jnm == "靛沧海" then
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效(jnm)
     self.拼接特效[1].偏移 = {x=0,y=0}
      qp = true
    elseif jnm == "苍茫树" then
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效(jnm)
     self.拼接特效[1].偏移 = {x=0,y=0}
      qp = true
    elseif jnm == "地裂火" then
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效(jnm)
     self.拼接特效[1].偏移 = {x=0,y=0}
      qp = true
    elseif jnm == "奔雷咒" then
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效(jnm)
     self.拼接特效[1].偏移 = {x=0,y=0}
      qp = true
    elseif jnm == "水漫金山" then
      self.全屏加速= 1.48
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效("水漫金山")
     self.拼接特效[1].偏移 = {x=0,y=0}
      -- for s=2,6 do
      --   self.拼接特效[s] = {}
      --   self.拼接特效[s].特效 = 单位:加载特效("水漫金山2")
      --   self.拼接特效[s].偏移 = {x=-360+((s-2)*180-120),y=375-75-((s-2)*75)}
      -- end
      -- for s=7,11 do
      --   self.拼接特效[s] = {}
      --   self.拼接特效[s].特效 = 单位:加载特效("水漫金山2")
      --   self.拼接特效[s].偏移 = {x=-360+((s-7)*180-160),y=250-75-((s-7)*75)}
      -- end
      qp = true
    elseif jnm == "地狱烈火" then
      self.全屏加速= 1.48
     self.拼接特效 = {}
     self.拼接特效[1] = {}
     self.拼接特效[1].特效 = 单位:加载特效("地狱烈火")
     self.拼接特效[1].偏移 = {x=0,y=0}
      -- for s=2,6 do
      --   self.拼接特效[s] = {}
      --   self.拼接特效[s].特效 = 单位:加载特效("地狱烈火2")
      --   self.拼接特效[s].偏移 = {x=-360+((s-2)*180-120),y=375-75-((s-2)*75)}
      -- end
      -- for s=7,11 do
      --   self.拼接特效[s] = {}
      --   self.拼接特效[s].特效 = 单位:加载特效("地狱烈火2")
      --   self.拼接特效[s].偏移 = {x=-360+((s-7)*180-160),y=250-75-((s-7)*75)}
      -- end
      qp = true
  end
  if qp then
    if 单位.敌我 == 1 then
      self.拼接偏移.x,self.拼接偏移.y = 全局游戏宽度-212-150,全局游戏高度-201--638,449
    else
      self.拼接偏移.x,self.拼接偏移.y = 358,236
    end
  end
end

function 战斗类:添加战斗提醒文字(q)
  self.战斗信息提示.开关=true
  self.战斗信息提示.文字=q
  self.战斗信息提示.起始时间=os.time()
end

function 战斗类:显示(dt,x,y)
  self.纯色背景:显示(0,0)
  self.战斗圆背景:更新(dt)
  self.战斗背景:显示(全局游戏宽度/2-235,全局游戏高度/2-125)
  self.战斗圆背景:显示(全局游戏宽度/2+5,全局游戏高度/2+35)
  if self.背景状态 == 1 then
    self.黑幕背景:显示(0,0)
  end
  if self.观战模式 then
    self.观战按钮:更新(x,y)
    if self.观战按钮:事件判断() then
      发送数据(5510)
    end
  end
  if self.观战模式 then
      self.观战底图:显示(全局游戏宽度/2-80,全局游戏高度-620)
      zts:显示(全局游戏宽度/2-46,全局游戏高度-580," 观 战 模 式")
      self.观战按钮:显示(全局游戏宽度/2-75,全局游戏高度-610)
  end
  if self.战斗类型 ~= 0 then
    self.切换阵营:更新(x,y)
    if self.切换阵营:事件判断() then
      for i=1,#self.战斗单位 do
        if self.战斗单位[i].队伍 ~= self.队伍id then
          self.队伍id = self.战斗单位[i].队伍
          break
        end
      end
      for i=1,#self.战斗单位 do
        self.战斗单位[i]:创建单位(self.战斗单位[i],self.战斗单位[i].队伍,i)
      end
    end
  end
  if self.战斗类型 ~= 0 then
      self.切换阵营:显示(全局游戏宽度/2,全局游戏高度-610)
  end
  for n=1,#self.战斗单位 do
    if self.观战模式 then
     self.战斗单位[n]:显示(dt,x,y)
    else
      self.战斗单位[n]:显示(dt,x,y)
    end
  end
  for n=1,#self.战斗单位 do
    self.战斗单位[n]:血条显示(x,y)
  end
  for n=1,#self.战斗单位 do
    if self.战斗单位[n].掉血开关 then
      if self.战斗单位[n].伤害类型==1  then
        self.战斗单位[n]:掉血显示()
        -- self.战斗单位[n]:暴击显示()
      elseif self.战斗单位[n].伤害类型==3 or self.战斗单位[n].伤害类型==4  then
        self.战斗单位[n]:暴击显示()
      else
        self.战斗单位[n]:加血显示()
      end
    end
  end
  if self.进程=="命令" then
    self.战斗指令:显示(dt,x,y)
    self.秒显示=0
    self.分显示=0
    self.结果=时间-self.命令数据.计时
    self.显示时间=0
    --print(self.结果)
    if self.结果>=1 then
      self.命令数据.计时=时间
      self.命令数据.秒=self.命令数据.秒-1
      if self.命令数据.秒<0 then
        if self.命令数据.分<=0 and self.命令数据.秒<=0 then
          self.战斗指令:结束()
          self.进程="等待"
          self.显示时间=1
        elseif self.命令数据.秒<=0 then
          self.命令数据.秒=9
          self.命令数据.分=self.命令数据.分-1
        end
      end
    end
    if self.显示时间==0 then
      self.分显示=self.命令数据.分+1
      if self.分显示>10 then
       self.分显示=1
      end
      self.秒显示=self.命令数据.秒+1
      if self.秒显示>10 then
       self.秒显示=1
      end
      -- print(self.分显示,self.秒显示)
      self.数字图片[self.分显示]:显示(全局游戏宽度/2-70,全局游戏高度-550)
      self.数字图片[self.秒显示]:显示(全局游戏宽度/2-20,全局游戏高度-550)
    end
    if self.提示 ~= "" and self.提示 ~= nil then
      tp.提示:战斗提示(x,y,self.提示)
    end
  elseif self.进程=="等待" then
    self.请等待:显示(全局游戏宽度/2-70,全局游戏高度-550)
  end
  if self.进程=="执行" then
    if self.战斗信息提示.开关 then
      self.战斗信息提示.字体:显示(全局游戏宽度-480,全局游戏高度-100,self.战斗信息提示.文字)
      if os.time()-self.战斗信息提示.起始时间 >=2 then
        self.战斗信息提示.开关 =false
      end
    end
    if self.拼接特效 ~= nil then
      for n=1,#self.拼接特效 do
        self.拼接特效[n].特效:显示(self.拼接偏移.x + self.拼接特效[n].偏移.x ,self.拼接偏移.y + self.拼接特效[n].偏移.y)
      end
      if self.是否拼接 ~= true then
        self.是否拼接 = true
      end
    end
  end
  if self.自动开关 then
    self.自动栏.鼠标=false
    self.自动栏:检查点(x,y)
    self.自动栏:显示(dt,x,y)
  end
end
return 战斗类